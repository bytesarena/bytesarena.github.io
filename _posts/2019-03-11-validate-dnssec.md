---
layout: post
title: How to validate DNSSEC for your domain
categories: DNS DNSSEC
---

So you have just signed your zone with DNSSEC. Hopefully you did everything right and everything works OK. If so, that all well and good. But how do you verify that you did everything correctly? After all, there are a number of things that could have gone wrong. 

In this article, we will discuss a couple of ways to verify that your signed zone is validated correctly by the security aware, validating resolvers on the internet. 


Though not many, there are a few reliable tools which you can use to confirm if your signed zone is working correctly. 

We will take the example of a known signed zone on the internet, **us.gov** and a zone where DNSSEC signing has issues at the time of writing this article, the TLD **mg**.

### dnsviz.net

DNSviz, or dnsviz.net is sort of a go to site for DNS administrators working with DNSSEC. 

The site diagramatically shows the path taken to validate a signed zone. 

The below screenshot shows the report generated by dnsviz.net for **us.gov**.

![us.gov](/assets/images/dnsviz-us-gov.png)


See the below screenshot for the report generated for **mg**.

![mg](/assets/images/dnsviz-mg.png)

The errors are better explained by the left side panel on the site.

![errors](/assets/images/dnsviz-errors.jpg)


The site offers a plethora of additional features, my favourite of which is historical DNSSEC data. With this, you can figure out if your domain had issues a week back or a year back. Isnt't that awesome?

### DIG + Sigchase

If you prefer the command line to the flashiness of the webUI (like me), then **dig** is your pal.

If you are a DNS administrator, then **DIG (Domain Information Grouper)** is likely your favourite client side, DNS tool.
`
**Dig** has a built in feature called **gigchase** which allows you to see the DNSSEC validation on the command line. 

```bash
╭─nd33p@trv-wl-srenjith ~
╰─$ dig -h | grep sigchase
                 +[no]sigchase       (Chase DNSSEC signatures)
                 +[no]topdown        (Do +sigchase in top-down mode)
                 +trusted-key=####   (Trusted Key to use with +sigchase)
```

To use **sigchase** with dig, first, you need a trust anchor. A trust anchor is where trust begins in DNSSEC. It is a trusted key which you ***absolutely know*** is valid and authentic. 

Here, I am using the Key Signing Key for the root zone. 

The key signing key, is the DNSKEY record for a zone which has the value 257 in the flags field. 

Here is the response, if you query the DNSKEY record for the root zone. 

```bash

╭─nd33p@trv-wl-srenjith ~
╰─$ dig . dnskey

; <<>> DiG 9.11.3-1ubuntu1.5-Ubuntu <<>> . dnskey
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 29833
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1452
;; QUESTION SECTION:
;.                              IN      DNSKEY

;; ANSWER SECTION:
.                       9240    IN      DNSKEY  256 3 8 AwEAAcH+axCdUOsTc9o+jmyVq5rsGTh1EcatSumPqEfsPBT+whyj0/Uh D7cWeixV9Wqzj/cnqs8iWELqhdzGX41ZtaNQUfWNfOriASnWmX2D9m/E unplHu8nMSlDnDcT7+llE9tjk5HI1Sr7d9N16ZTIrbVALf65VB2ABbBG 39dyAb7tz21PICJbSp2cd77UF7NFqEVkqohl/LkDw+7Apalmp0qAQT1M gwi2cVxZMKUiciA6EqS+KNajf0A6olO2oEhZnGGY6b1LTg34/YfHdiII ZQqAfqbieruCGHRiSscC2ZE7iNreL/76f4JyIEUNkt6bQA29JsegxorL zQkpF7NKqZc=
.                       9240    IN      DNSKEY  257 3 8 AwEAAaz/tAm8yTn4Mfeh5eyI96WSVexTBAvkMgJzkKTOiW1vkIbzxeF3 +/4RgWOq7HrxRixHlFlExOLAJr5emLvN7SWXgnLh4+B5xQlNVz8Og8kv ArMtNROxVQuCaSnIDdD5LKyWbRd2n9WGe2R8PzgCmr3EgVLrjyBxWezF 0jLHwVN8efS3rCj/EWgvIWgb9tarpVUDK/b58Da+sqqls3eNbuv7pr+e oZG+SrDK6nWeL3c6H5Apxz7LjVc1uTIdsIXxuOLYA4/ilBmSVIzuDWfd RUfhHdY6+cn8HFRm+2hM8AnXGXws9555KrUB5qihylGa8subX2Nn6UwN R1AkUTV74bU=
.                       9240    IN      DNSKEY  385 3 8 AwEAAagAIKlVZrpC6Ia7gEzahOR+9W29euxhJhVVLOyQbSEW0O8gcCjF FVQUTf6v58fLjwBd0YI0EzrAcQqBGCzh/RStIoO8g0NfnfL2MTJRkxoX bfDaUeVPQuYEhg37NZWAJQ9VnMVDxP/VHL496M/QZxkjf5/Efucp2gaD X6RS6CXpoY68LsvPVjR0ZSwzz1apAzvN9dlzEheX7ICJBBtuA6G3LQpz W5hOA2hzCTMjJPJ8LbqF6dsV6DoBQzgul0sGIcGOYl7OyQdXfZ57relS Qageu+ipAdTTJ25AsRTAoub8ONGcLmqrAmRLKBP1dfwhYB4N7knNnulq QxA+Uk1ihz0=

;; Query time: 26 msec
;; SERVER: 1.1.1.1#53(1.1.1.1)
;; WHEN: Mon Mar 11 15:58:00 DST 2019
;; MSG SIZE  rcvd: 853

```

From this output, we will extract the key signing key and save it to a file. 

```bash

╭─nd33p@trv-wl-srenjith ~
╰─$ dig . dnskey | grep 257 > root-ksk.txt

```

Lets check the file. 

```bash
╭─nd33p@trv-wl-srenjith ~
╰─$ cat root-ksk.txt
.                       9171    IN      DNSKEY  257 3 8 AwEAAaz/tAm8yTn4Mfeh5eyI96WSVexTBAvkMgJzkKTOiW1vkIbzxeF3 +/4RgWOq7HrxRixHlFlExOLAJr5emLvN7SWXgnLh4+B5xQlNVz8Og8kv ArMtNROxVQuCaSnIDdD5LKyWbRd2n9WGe2R8PzgCmr3EgVLrjyBxWezF 0jLHwVN8efS3rCj/EWgvIWgb9tarpVUDK/b58Da+sqqls3eNbuv7pr+e oZG+SrDK6nWeL3c6H5Apxz7LjVc1uTIdsIXxuOLYA4/ilBmSVIzuDWfd RUfhHdY6+cn8HFRm+2hM8AnXGXws9555KrUB5qihylGa8subX2Nn6UwN R1AkUTV74bU=
```

Now we can use this trust anchor file, with dig +sigchase to validate DNSSEC domains. 

Below is the output for the domain **us.gov**.

```bash

╭─nd33p@trv-wl-srenjith ~
╰─$ dig us.gov +sigchase +trusted-key=root-ksk.txt
;; RRset to chase:
us.gov.                 300     IN      A       54.85.132.205


;; RRSIG of the RRset to chase:
us.gov.                 300     IN      RRSIG   A 8 2 300 20190330173133 20190228172633 56698 us.gov. WZBomyKfJUTNGMDElUoIBCmn9Rfvmcsfj7qhGJGzz+vdJ8QSHNsj/D4Q Z3QLCpTVAaAMfCHM+cPtLWoIkLhkOoYbkeiDuBBtQkH5AFwVOVnYIomk diwCHgPErR9QHfJ60tT9PunB/CWJYw3h3AOrpbogqgDWlIyNr5hkzNyn d3E=



Launch a query to find a RRset of type DNSKEY for zone: us.gov.

;; DNSKEYset that signs the RRset to chase:
us.gov.                 7861    IN      DNSKEY  257 3 8 AwEAAbXgvj7WxatxwkiqWcPhsaoV5nuEEiYYHHl53dZTIjN7/zbfcC4S YwR/vd+tQarrIXM8aNSB8KkYUHT4HGGAkKwObJO7h+7QYgunssIznCA8 wHwt6/buRANdfhSScCSb2oAE8+EUC2kBDWTWDcMe7L6sYvHt+B08x+pd Ncskq3Tv
us.gov.                 7861    IN      DNSKEY  256 3 8 AwEAAfAcBNYr1rItRH7UAB1jed7LtM/9W8cafBE7sYIG2v5NdG1bRLda PJ13gs1hr5BXSnwG1gGxofjsNfK2BI+cL3ymVqWBFhr1p3Cx3oz/+fzp x/wl9Ugb3TmJ7BeZAqUt9anP8TufeAwAUnvyy2J1g4xAiXldiaQxAgOq tb3sda1x


;; RRSIG of the DNSKEYset that signs the RRset to chase:
us.gov.                 7861    IN      RRSIG   DNSKEY 8 2 10800 20190330173133 20190228172633 56698 us.gov. e6eZih58ah2ofZHU1tE54qMffvgLzL5YXdDex0xOpRCDsp3o27t4TV9X 7xleFLVXTk/JmiFHLMzQ/o/8hgIrHproYfbojw2/MMZkMyIg/5/DZaS9 XEsdPYa1CCYT+YlN7ozJhqViUxO6xkrxuLkSCpQarUBUedlJZOvBO3wr HRs=
us.gov.                 7861    IN      RRSIG   DNSKEY 8 2 10800 20190330173133 20190228172633 31834 us.gov. f8HOiCM8s9De3dW5LXl7Kag2K1NapZVftHgOUNUdg54XsMxcHh6052JE SIMB82YllmjUbooWsxbpsIqL/kO8zzW7D8eOV4+E1YnLQNhpSYP5wKnz ROxYhdGtv5jIwRiBnSScDXhAEoAdaF5936TpDy55smm8ZZ+nevQMLhj9 4j4=



Launch a query to find a RRset of type DS for zone: us.gov.

;; DSset of the DNSKEYset
us.gov.                 661     IN      DS      31834 8 1 4B6818D072CE89257679235112D8CCD5D6566AA4
us.gov.                 661     IN      DS      31834 8 2 CEC6434AA760480BBE7756C7CA6B98FF25392AD3F21EBB0B61B51816 17CCAEF4


;; RRSIG of the DSset of the DNSKEYset
us.gov.                 661     IN      RRSIG   DS 8 2 3600 20190318041007 20190311041007 28157 gov. cIdDq5JHG4lUMAS5YUyJT/xaxJrOB5ysve3Eb9WgpmKHPkqR+j9f0uC5 /JQ609X71XIpfM0MT0HT7zeSmFf3C4yBMKwiseRLdt44KadgRqQFVNGM KRYeMM7N+ELSR/zzWT4RYjdaB2W3W4b32BxoVnZQFInP0+q0bnsp7/9N XuI=




;; WE HAVE MATERIAL, WE NOW DO VALIDATION
;; VERIFYING A RRset for us.gov. with DNSKEY:56698: success
;; OK We found DNSKEY (or more) to validate the RRset
;; Now, we are going to validate this DNSKEY by the DS
;; OK a DS valids a DNSKEY in the RRset
;; Now verify that this DNSKEY validates the DNSKEY RRset
;; VERIFYING DNSKEY RRset for us.gov. with DNSKEY:31834: success
;; OK this DNSKEY (validated by the DS) validates the RRset of the DNSKEYs, thus the DNSKEY validates the RRset
;; Now, we want to validate the DS :  recursive call


Launch a query to find a RRset of type DNSKEY for zone: gov.

;; DNSKEYset that signs the RRset to chase:
gov.                    9005    IN      DNSKEY  257 3 8 AQO8daaz7B+yshOfL60rytKd9aOSujgponEw3fwBMEC3/+e9XzHw2k+V KnbJTZ+QaVtpfUd1q9HKZIv/ck83Gl5TjYKE5jtUZ2kpEDZfVNGv6yx0 smtWAXv1nCJS9ohnyOTd397eMojGDHqkEC+uojEScZheEkMxzgCZwDAs +/CSU7mSuHtCRZn19xlZUd5Gv7yDQ3mbOUwuy30oSk0z1Q5UUPpoihOu gIZHFX6Jk7NLiW2wlqfq9qhV4zj7TiBiJY0mCc4zHN8/aq2VKDHp2Na7 mWzvKyTy+SYQkBQ/08LbPwj9YMc+uCzKL6sU/ObHv17EFhD8aPDftTHZ vV9L+OZr
gov.                    9005    IN      DNSKEY  256 3 8 AQO1oAFyB/QSuf32vdl3Yp+o83rKLBdvjsz13AdVp8EooKwa6DL4D8G+ e3PanKAJyWEiRpNQIAl2Ra6JuC7DCiEPBziclmFygf2XGdY4qirPqVem cHHKNoVIMNUteughuiPaqlFY8gTZajQ02ZizqiYK+LRxpPs/ePcbETPT 3oB9Ew==


;; RRSIG of the DNSKEYset that signs the RRset to chase:
gov.                    9005    IN      RRSIG   DNSKEY 8 1 86400 20190323224731 20190308224231 7698 gov. P0zo4ZW2IofCfqSx+8QNKgU+S+hztaNv7X+BU4p7Rqzq28KrZ4yYoe0y m+wqJKPDMztteMhvs47SwepfxKt1PaQYVuEE3I9yvMuE9WtYVwz+buEI mOdLNNw3YfUFxNzDLKfxiUQBK9+9o8oW13sMppOJailnLIv66pLAAG6c ERwAO0nKy5MvWhNKZ5KojNnn4lx5mr+zFre967gR3eWDypIbGMzlWg6N Ew/HQbEYAEcOiclmalJ6Ds7Sg6AIX8q7tf8DhuocteRx5xZO/QfCj2tZ 6uYn2qdZ25vhz9TqmZOKsTEZm0UZTKr4Qx3UOqshlvFeIINN0tZ68YhA eCoVRQ==



Launch a query to find a RRset of type DS for zone: gov.

;; DSset of the DNSKEYset
gov.                    10301   IN      DS      7698 8 1 6F109B46A80CEA9613DC86D5A3E065520505AAFE
gov.                    10301   IN      DS      7698 8 2 6BC949E638442EAD0BDAF0935763C8D003760384FF15EBBD5CE86BB5 559561F0


;; RRSIG of the DSset of the DNSKEYset
gov.                    10301   IN      RRSIG   DS 8 1 86400 20190324050000 20190311040000 16749 . EmthMlUTxlANKSFIBWlRRZ+sPGPd9MuDg2vDJ6SEgx8XPA0JuRhdtFJu t6qaNjfTn2u7Khi/fpsqW+lEB4pqFTleTMhb21m9vr+vTpIFGTfSkNlo VYx9sOCNiCDN/HjBGtVgtq+AWdH9VbZ38YyU0kxGvH+X9b5KM3thqy9M UZeb8BmxfhqkjYkIdKqG7sGpCUxJX4gQGxX8qObgsbf7KGN2nvCi+8h5 c0y6LLYD85r5krHOrJlGJD0VltvxI1WtTTEee3vyNfI1B3Mxt7SZP4ev XuXC55ZeGtZjRhSvBOgFY93ruru5NjIwUZ/ZmW43dpdqxsi52EjnFCP7 BivpUQ==




;; WE HAVE MATERIAL, WE NOW DO VALIDATION
;; VERIFYING DS RRset for us.gov. with DNSKEY:28157: success
;; OK We found DNSKEY (or more) to validate the RRset
;; Now, we are going to validate this DNSKEY by the DS
;; OK a DS valids a DNSKEY in the RRset
;; Now verify that this DNSKEY validates the DNSKEY RRset
;; VERIFYING DNSKEY RRset for gov. with DNSKEY:7698: success
;; OK this DNSKEY (validated by the DS) validates the RRset of the DNSKEYs, thus the DNSKEY validates the RRset
;; Now, we want to validate the DS :  recursive call


Launch a query to find a RRset of type DNSKEY for zone: .

;; DNSKEYset that signs the RRset to chase:
.                       9004    IN      DNSKEY  256 3 8 AwEAAcH+axCdUOsTc9o+jmyVq5rsGTh1EcatSumPqEfsPBT+whyj0/Uh D7cWeixV9Wqzj/cnqs8iWELqhdzGX41ZtaNQUfWNfOriASnWmX2D9m/E unplHu8nMSlDnDcT7+llE9tjk5HI1Sr7d9N16ZTIrbVALf65VB2ABbBG 39dyAb7tz21PICJbSp2cd77UF7NFqEVkqohl/LkDw+7Apalmp0qAQT1M gwi2cVxZMKUiciA6EqS+KNajf0A6olO2oEhZnGGY6b1LTg34/YfHdiII ZQqAfqbieruCGHRiSscC2ZE7iNreL/76f4JyIEUNkt6bQA29JsegxorL zQkpF7NKqZc=
.                       9004    IN      DNSKEY  257 3 8 AwEAAaz/tAm8yTn4Mfeh5eyI96WSVexTBAvkMgJzkKTOiW1vkIbzxeF3 +/4RgWOq7HrxRixHlFlExOLAJr5emLvN7SWXgnLh4+B5xQlNVz8Og8kv ArMtNROxVQuCaSnIDdD5LKyWbRd2n9WGe2R8PzgCmr3EgVLrjyBxWezF 0jLHwVN8efS3rCj/EWgvIWgb9tarpVUDK/b58Da+sqqls3eNbuv7pr+e oZG+SrDK6nWeL3c6H5Apxz7LjVc1uTIdsIXxuOLYA4/ilBmSVIzuDWfd RUfhHdY6+cn8HFRm+2hM8AnXGXws9555KrUB5qihylGa8subX2Nn6UwN R1AkUTV74bU=
.                       9004    IN      DNSKEY  385 3 8 AwEAAagAIKlVZrpC6Ia7gEzahOR+9W29euxhJhVVLOyQbSEW0O8gcCjF FVQUTf6v58fLjwBd0YI0EzrAcQqBGCzh/RStIoO8g0NfnfL2MTJRkxoX bfDaUeVPQuYEhg37NZWAJQ9VnMVDxP/VHL496M/QZxkjf5/Efucp2gaD X6RS6CXpoY68LsvPVjR0ZSwzz1apAzvN9dlzEheX7ICJBBtuA6G3LQpz W5hOA2hzCTMjJPJ8LbqF6dsV6DoBQzgul0sGIcGOYl7OyQdXfZ57relS Qageu+ipAdTTJ25AsRTAoub8ONGcLmqrAmRLKBP1dfwhYB4N7knNnulq QxA+Uk1ihz0=


;; RRSIG of the DNSKEYset that signs the RRset to chase:
.                       9004    IN      RRSIG   DNSKEY 8 0 172800 20190323000000 20190302000000 20326 . lyFA5o1sdapiyamfsxd+2XCm5RrMcbw0T7K2mPI+I01v604j6cC+jfEV XaqXv+sefTSldItK68TWp2XcUB/ZyySXe3F0oLVyKUiNIqB5gWYmHicz ZnE8TXKf48ljXWBmvLh0p/mKsgLEPIA2YFdub++XweFpHxErOWCQYckC JkG73U5VqTD5S9y6LrJ2nW/7icq2+utQqJb/qTTZv1UESLlzQ5WsJb+b OkdMdA1EYBk4TkAPspRdQijZ0mRyiZWHfXoEUk3meOqUtqnbtLLkbE/K oXN10ZXETYOFZD2tnx0c1HRJYYwTTbkdW4QR8TyxSyqAUH5ajYp5o6N3 dTUN4A==
.                       9004    IN      RRSIG   DNSKEY 8 0 172800 20190323000000 20190302000000 19164 . DF4aaOz2P+EtC6fluzsrOWhy7at1g+3/G3YICFhqkHRH8q9gPEQ4GLjr 0aQk3eZX0n96kfdVMmZcaIi9PVVlOnXUcqWayxSAOKVDJCOth56KDNTv rLvvgy51WCUv6upNNvNLIU0Z4kzTzbUlfbV+QoeUUvBcWeYafKydjGfp 7qNuRUc/nTzL6zdnkd1cNeI0v+rGjGJiXyPa64DotB6pQ0++bo7lQtQK 8HkoDzuih7WllQC9jD/y2rbhyS+jsmHsD85q6vVAeEAvp2SfDN1SXpsG SwlSc/6BjksTfcQL+94FOuINlPs1u1cXbc7rpiIYg4tE1y+EO/FTS56R J0SWaQ==



Launch a query to find a RRset of type DS for zone: .
;; NO ANSWERS: no more

;; WARNING There is no DS for the zone: .



;; WE HAVE MATERIAL, WE NOW DO VALIDATION
;; VERIFYING DS RRset for gov. with DNSKEY:16749: success
;; OK We found DNSKEY (or more) to validate the RRset
;; Ok, find a Trusted Key in the DNSKEY RRset: 20326
;; VERIFYING DNSKEY RRset for . with DNSKEY:20326: success

;; Ok this DNSKEY is a Trusted Key, DNSSEC validation is ok: SUCCESS

```

I know that looks like a lot of output. But read through it. There are comments that clearly explain how the validation process is going. 

Now let's look at the **mg** domain. 

```
